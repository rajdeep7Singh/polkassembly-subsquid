enum ProposalType {
  AllianceMotion
  Announcement
  UnscrupulousItem
}

enum ProposalStatus {
  Proposed
  Passed
  NotPassed
  Cancelled
  Executed
  Approved
  Disapproved
  Closed
  Announced
  Removed
  Added
  Rejected
  Active
  Confirmed
  TimedOut
}

type MotionThreshold {
  value: Int!
}

enum ReferendumThresholdType {
  SuperMajorityApprove
  SuperMajorityAgainst
  SimpleMajority
}

type ReferendumThreshold {
  type: ReferendumThresholdType!
}

union Threshold = MotionThreshold | ReferendumThreshold

type Proposal @entity {
  id: ID!
  type: ProposalType! @index
  hash: String @index
  index: Int @index
  proposer: String
  deposit: BigInt
  threshold: Threshold
  end: Int
  description: String
  proposalArgumentHash: String
  callData: ProposedCall
  digest: String
  announcement: Announcements
  voting: [Vote!] @derivedFrom(field: "proposal")
  status: ProposalStatus!
  statusHistory: [StatusHistory!] @derivedFrom(field: "proposal")
  tally: Tally
  executeAtBlockNumber: Int
  executedAt: DateTime
  createdAtBlock: Int! @index
  createdAt: DateTime! @index
  endedAtBlock: Int
  endedAt: DateTime
  updatedAtBlock: Int @index
  updatedAt: DateTime @index
}

enum AnnouncementType {
  Account
  Website
  Announcement
}

type Announcements @entity {
  id: ID!
  hash: String! @index
  index: Int @index
  proposer: String @index
  type: AnnouncementType @index
  version: String
  codec: BigInt
  announcement: JSON
  digest: String
  cid: String
  proposal: Proposal
  code: BigInt
  isRemoved: Boolean
  status: ProposalStatus!
  statusHistory: [StatusHistory!] @derivedFrom(field: "announcement")
  createdAt: DateTime! @index
  createdAtBlock: Int! @index
  updatedAt: DateTime @index
  updatedAtBlock: Int @index
}

type Tally {
  ayes: BigInt
  nays: BigInt
  support: BigInt
  bareAyes: BigInt
}

type StatusHistory @entity {
  id: ID!
  proposal: Proposal
  announcement: Announcements
  status: ProposalStatus!
  block: Int!
  timestamp: DateTime!
}

type ProposedCall {
  section: String!
  method: String!
  args: JSON
  description: String!
}

enum VoteDecision {
  yes
  no
  abstain
  split
  splitAbstain
}

type StandardVoteBalance {
  value: BigInt
}

type SplitVoteBalance {
  aye: BigInt
  nay: BigInt
  abstain: BigInt
}

union VoteBalance = StandardVoteBalance | SplitVoteBalance

enum VoteType {
  AllianceMotion
}

type Vote @entity {
  id: ID!
  voter: String
  proposalId: ID!
  proposal: Proposal!
  blockNumber: Int! @index
  timestamp: DateTime! @index
  decision: VoteDecision
  balance: VoteBalance
  lockPeriod: Int
  type: VoteType
}